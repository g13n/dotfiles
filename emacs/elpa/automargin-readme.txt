Require this script and enable automargin-mode.

  (when (require 'automargin nil t)
    (automargin-mode 1))

then, if the frame is not splitted horizontally, margins are set automatically.
